{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport CriminalInfo from \"./CriminalInfo.vue\";\nimport axios from \"axios\";\nexport default {\n  components: {\n    CriminalInfo\n  },\n  data() {\n    return {\n      inputID: \"\",\n      content: [],\n      curLevel: -1,\n      imageUrl: require(\"../../assets/criminal.png\"),\n      placeholder: \"请输入居民身份证号\",\n      isGraphContainerVisible: false,\n      readyToRenderGraph: false,\n      isError: false,\n      // 控制错误动画\n      // 以下为渲染信息相关\n      curInfo: 0,\n      // 当前加载位置\n      infoList: [] // 用于存储渲染的信息\n    };\n  },\n\n  watch: {\n    content: {\n      handler() {\n        this.infoList = [];\n        this.curInfo = 0;\n        setTimeout(() => {\n          this.readyToRenderGraph = true;\n          setInterval(() => {\n            if (this.curLevel < 2) this.curLevel++;\n          }, 500);\n        }, 500);\n        // 设置infoList\n        setInterval(() => {\n          if (this.curInfo < this.content.people.length) {\n            this.infoList.push(this.content.people[this.curInfo]);\n            this.curInfo++;\n          }\n        }, 300);\n      }\n    }\n  },\n  methods: {\n    getPos(index) {\n      let width = this.$el.offsetWidth;\n      let height = this.$el.offsetHeight;\n      let top = \"0%\";\n      let left = \"0%\";\n      if (index == 0) {\n        // 中心人物\n        top = `${height / 4 * 2 - 100}px`;\n        left = `${width / 2 - 250}px`;\n      } else if (index == 1 || index == 2) {\n        // 父母\n        top = `${height / 4 - 100 - 50}px`;\n        left = `${width / 100 * index * 30 - 200}px`;\n      } else {\n        // 孩子关系\n        let leftChild = this.content.people.length - 3;\n        top = `${height / 4 * 3 - 80}px`;\n        left = `${width / (leftChild + 1) * (index - 2) - 200}px`;\n        console.log(leftChild, index, left);\n      }\n      return {\n        top,\n        left\n      };\n    },\n    startErrorAnime() {\n      this.isError = true;\n      // 重置显示已有的输入内容为空\n      this.inputID = \"\";\n      this.placeholder = \"不存在此犯人，请重新输入\";\n      setTimeout(() => {\n        this.isError = false;\n        this.inputID = \"\";\n        this.placeholder = \"\";\n      }, 500);\n    },\n    query() {\n      this.curLevel = -1;\n      axios.post(\"http://localhost:7078/api/FamilybgCheck\", {\n        InputText: this.inputID\n      }).then(response => {\n        if (response.data.people.length !== 0) {\n          // 有数据\n          this.content = response.data;\n          this.isGraphContainerVisible = true;\n          this.isError = false;\n        } else {\n          this.startErrorAnime();\n          this.readyToRenderGraph = false;\n        }\n      }).catch(error => {\n        console.error(error);\n        this.startErrorAnime();\n      });\n    },\n    changeInputStatus() {\n      if (this.placeholder === \"\") {\n        this.placeholder = \"请输入居民身份证号\";\n      } else {\n        this.placeholder = \"\";\n      }\n    }\n  },\n  mounted() {}\n};","map":{"version":3,"names":["CriminalInfo","axios","components","data","inputID","content","curLevel","imageUrl","require","placeholder","isGraphContainerVisible","readyToRenderGraph","isError","curInfo","infoList","watch","handler","setTimeout","setInterval","people","length","push","methods","getPos","index","width","$el","offsetWidth","height","offsetHeight","top","left","leftChild","console","log","startErrorAnime","query","post","InputText","then","response","catch","error","changeInputStatus","mounted"],"sources":["C:\\GitHubWarehouse\\2023-TJU-DBD-Police-Affair-System\\My-front\\dbproject\\src\\components\\UrbanResidentmanagement\\FamilybgCheck.vue"],"sourcesContent":["<template>\r\n<el-header class=\"sub-header\">\r\n    <div>&nbsp;&nbsp;城区和居民管理&nbsp;>&nbsp;家族背景调查</div>\r\n  </el-header>\r\n\r\n  <div class=\"container\">\r\n    <!-- main window -->\r\n    <!-- element:query inputbox and confirm button-->\r\n    <div class=\"queryBox\" :class=\"{ upBox: isGraphContainerVisible }\">\r\n      <input\r\n        type=\"text\"\r\n        v-model=\"inputID\"\r\n        :placeholder=\"placeholder\"\r\n        @focus=\"changeInputStatus\"\r\n        @blur=\"changeInputStatus\"\r\n        @keydown.enter=\"query\"\r\n        class=\"inputBox\"\r\n        :class=\"{ errorAnime: isError }\"\r\n      />\r\n      <button @click=\"query\" class=\"button\">查询</button>\r\n    </div>\r\n    <!-- element:family graph container -->\r\n    <!-- graph is where criminal info is shown -->\r\n    <div v-if=\"readyToRenderGraph\" class=\"graphContainer\">\r\n      <!-- this part is for info render,\r\n     step1: calc position and sequential for each info\r\n     step2: render by sequential -->\r\n      <transitionGroup name=\"fade\" tag=\"ul\">\r\n        <div\r\n          class=\"imgCtrl\"\r\n          v-for=\"(item, index) in this.infoList\"\r\n          :style=\"getPos(index)\"\r\n          :key=\"index\"\r\n        >\r\n          <CriminalInfo :imgUrl=\"imageUrl\" :content=\"item\" />\r\n        </div>\r\n      </transitionGroup>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport CriminalInfo from \"./CriminalInfo.vue\";\r\nimport axios from \"axios\";\r\nexport default {\r\n  components: {\r\n    CriminalInfo,\r\n  },\r\n  data() {\r\n    return {\r\n      inputID: \"\",\r\n      content: [],\r\n      curLevel: -1,\r\n      imageUrl: require(\"../../assets/criminal.png\"),\r\n      placeholder: \"请输入居民身份证号\",\r\n      isGraphContainerVisible: false,\r\n      readyToRenderGraph: false,\r\n      isError: false, // 控制错误动画\r\n      // 以下为渲染信息相关\r\n      curInfo: 0, // 当前加载位置\r\n      infoList: [], // 用于存储渲染的信息\r\n    };\r\n  },\r\n  watch: {\r\n    content: {\r\n      handler() {\r\n        this.infoList = [];\r\n        this.curInfo = 0;\r\n        setTimeout(() => {\r\n          this.readyToRenderGraph = true;\r\n          setInterval(() => {\r\n            if (this.curLevel < 2) this.curLevel++;\r\n          }, 500);\r\n        }, 500);\r\n        // 设置infoList\r\n        setInterval(() => {\r\n          if (this.curInfo < this.content.people.length) {\r\n            this.infoList.push(this.content.people[this.curInfo]);\r\n            this.curInfo++;\r\n          }\r\n        }, 300);\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    getPos(index) {\r\n      let width = this.$el.offsetWidth;\r\n      let height = this.$el.offsetHeight;\r\n      let top = \"0%\";\r\n      let left = \"0%\";\r\n      if (index == 0) {\r\n        // 中心人物\r\n        top = `${(height / 4) * 2 - 100}px`;\r\n        left = `${width / 2 - 250}px`;\r\n      } else if (index == 1 || index == 2) {\r\n        // 父母\r\n        top = `${height / 4 - 100 - 50}px`;\r\n        left = `${(width / 100) * index * 30 - 200}px`;\r\n      } else {\r\n        // 孩子关系\r\n        let leftChild = this.content.people.length - 3;\r\n        top = `${(height / 4) * 3 - 80}px`;\r\n        left = `${(width / (leftChild + 1)) * (index - 2) - 200}px`;\r\n        console.log(leftChild, index, left);\r\n      }\r\n      return {\r\n        top,\r\n        left,\r\n      };\r\n    },\r\n    startErrorAnime() {\r\n      this.isError = true;\r\n      // 重置显示已有的输入内容为空\r\n      this.inputID = \"\";\r\n      this.placeholder = \"不存在此犯人，请重新输入\";\r\n      setTimeout(() => {\r\n        this.isError = false;\r\n        this.inputID = \"\";\r\n        this.placeholder = \"\";\r\n      }, 500);\r\n    },\r\n    query() {\r\n      this.curLevel = -1;\r\n      axios\r\n        .post(\"http://localhost:7078/api/FamilybgCheck\", {\r\n          InputText: this.inputID,\r\n        })\r\n        .then((response) => {\r\n          if (response.data.people.length !== 0) {\r\n            // 有数据\r\n            this.content = response.data;\r\n            this.isGraphContainerVisible = true;\r\n            this.isError = false;\r\n          } else {\r\n            this.startErrorAnime();\r\n            this.readyToRenderGraph = false;\r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n          this.startErrorAnime();\r\n        });\r\n    },\r\n    changeInputStatus() {\r\n      if (this.placeholder === \"\") {\r\n        this.placeholder = \"请输入居民身份证号\";\r\n      } else {\r\n        this.placeholder = \"\";\r\n      }\r\n    },\r\n  },\r\n  mounted() {},\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.sub-header {\r\n  overflow: hidden;\r\n  display: flex;\r\n  position: absolute;\r\n  top: 70px;\r\n  left: 199px;\r\n  width: calc(100% - 199px);\r\n  height: 7vh;\r\n  min-height: 40px;\r\n  align-items: center; /* 文字竖直方向居中对齐 */\r\n background-color: #f2dccacf;\r\n  color: #000;\r\n  font-size: 30px;\r\n  font-weight: bold;\r\n}\r\n\r\n.queryBox {\r\n  width: 100%;\r\n  height: 100px;\r\n  position: relative;\r\n  top: 40vh;\r\n  overflow: hidden;\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  transition: transform 0.5s ease;\r\n}\r\n\r\n.upBox {\r\n  transform: translateY(-40vh);\r\n}\r\n.container {\r\n  margin-top: 10vh;\r\n \r\n  width: 100%;\r\n  height: 100vh;\r\n  position: relative;\r\n  overflow: hidden;\r\n\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n}\r\n.inputBox {\r\n  width: 250px;\r\n  height: 50px;\r\n  text-align: center;\r\n  border-radius: 16px;\r\n  font-size: 16px;\r\n  background: #ffffff;\r\n  padding: 3px;\r\n}\r\n.inputBox:focus {\r\n  outline: none;\r\n  border: 3px rgba(25, 167, 255, 0.644) solid;\r\n  box-shadow: 0 0 6px rgba(25, 167, 255, 0.644);\r\n}\r\n.inputBox:not(:focus) {\r\n  outline: none;\r\n  border: 1px rgba(158, 158, 158, 0.943) solid;\r\n  box-shadow: 0 0 0px rgba(158, 158, 158, 0.943);\r\n}\r\n.inputBox:hover:not(:focus) {\r\n  outline: none;\r\n  border: 1px rgba(158, 158, 158, 0.943) solid;\r\n  box-shadow: 0 0 5px rgba(214, 214, 214, 0.943);\r\n}\r\n.button {\r\n  width: 70px;\r\n  height: 55px;\r\n  text-align: center;\r\n  margin-left: 12px;\r\n  border-radius: 16px;\r\n  font-size: 16px;\r\n  color: #ffffff;\r\n  background: #00aeff;\r\n}\r\n.imgCtrl {\r\n  width: 400px;\r\n  height: 160px;\r\n  position: absolute;\r\n}\r\n.graphContainer {\r\n  width: 100%;\r\n  /* 高度：填满剩余屏幕 */\r\n  height: calc(100% - 100px);\r\n  position: relative; /* 子元素相对于父元素绝对位置 */\r\n  top: 9px;\r\n  overflow: hidden;\r\n}\r\n\r\n.imgAnime-enter-active {\r\n  transition: opacity 0.5s ease, transform 0.5s ease, width 0.5s ease,\r\n    height 0.5s ease; /* 添加宽度和高度的过渡效果 */\r\n}\r\n.imgAnime-leave-active {\r\n  transition: opacity 0.5s ease, transform 0.5s ease, width 0.5s ease,\r\n    height 0.5s ease; /* 添加宽度和高度的过渡效果 */\r\n}\r\n.imgAnime-enter {\r\n  opacity: 0;\r\n  transform: translateY(100%) scale(0); /* 添加初始的缩放效果 */\r\n}\r\n.imgAnime-leave-to {\r\n  opacity: 0;\r\n  transform: translateY(100%) scale(0); /* 添加最终的缩放效果 */\r\n}\r\n\r\n/* animation for shaking */\r\n.errorAnime {\r\n  outline: none;\r\n  border: 3px rgba(255, 56, 56, 0.943) solid !important;\r\n  animation: shake 0.2s infinite;\r\n}\r\n@keyframes shake {\r\n  0% {\r\n    transform: translateX(0);\r\n  }\r\n  25% {\r\n    transform: translateX(-5px);\r\n  }\r\n  50% {\r\n    transform: translateX(0);\r\n  }\r\n  75% {\r\n    transform: translateX(5px);\r\n  }\r\n  100% {\r\n    transform: translateX(0);\r\n  }\r\n}\r\n\r\n/* animation for info show */\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n  transition: all 0.5s cubic-bezier(0.55, 0, 0.1, 1);\r\n}\r\n\r\n/* 2. 声明进入和离开的状态 */\r\n.fade-enter-from,\r\n.fade-leave-to {\r\n  opacity: 0;\r\n  transform: scaleY(0.01) translate(30px, 0);\r\n}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}