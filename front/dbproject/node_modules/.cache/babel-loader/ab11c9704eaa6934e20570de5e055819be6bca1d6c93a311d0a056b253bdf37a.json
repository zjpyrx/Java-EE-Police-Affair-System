{"ast":null,"code":"import WebSocket from 'ws';\nexport default {\n  data() {\n    return {\n      url: 'ws://localhost:7078/Room/',\n      ws: null,\n      user: '',\n      message: '',\n      content: ''\n    };\n  },\n  created() {},\n  methods: {\n    async joinRoom() {\n      if (this.ws) {\n        alert(\"你已经再聊天室\");\n        return;\n      }\n      let url = this.url;\n      let username = this.user;\n      this.ws = new WebSocket('wss://localhost:7078/Room/' + username); // 后端的启动端口\n      this.ws.onopen = this.webscoketonopen;\n      this.ws.onmessage = this.webscoketonmessage;\n      //发生错误触发\n      this.ws.onerror = function (event) {\n        console.log(\"连接错误\" + event);\n      };\n      //正常关闭触发\n      this.ws.onclose = function () {\n        console.log(\"连接关闭\");\n      };\n    },\n    webscoketonopen() {\n      console.log(\"与服务器成功建立连接\");\n    },\n    webscoketonmessage(value) {\n      console.log(value);\n      this.content += value.data + '\\r\\n';\n    },\n    exitRoom() {\n      this.closeWebSocket();\n    },\n    sendMsg() {\n      if (!this.ws) {\n        alert('你已经掉线，请重新加入');\n        return;\n      }\n      if (this.ws.readyState === 1) {\n        this.ws.send(this.message);\n        this.message = '';\n      } else {\n        alert('发送失败');\n      }\n    },\n    closeWebSocket() {\n      if (this.ws) {\n        this.ws.close();\n        this.ws = null;\n      }\n    },\n    talking(content) {\n      console.log(content);\n    }\n  }\n};","map":{"version":3,"names":["WebSocket","data","url","ws","user","message","content","created","methods","joinRoom","alert","username","onopen","webscoketonopen","onmessage","webscoketonmessage","onerror","event","console","log","onclose","value","exitRoom","closeWebSocket","sendMsg","readyState","send","close","talking"],"sources":["D:\\Work\\大三上\\java\\endOfTermProj\\Java-EE-Police-Affair-System\\front\\dbproject\\src\\components\\SecretChat.vue"],"sourcesContent":["<template>\n    <div class=\"roomStyle\">\n    <br>欢迎使用<strong>VueTest</strong>极简聊天室：<br/><br/>\n    <textarea id=\"content\" v-model=\"content\" cols=\"60\" rows=\"30\" readonly=\"readonly\"></textarea><br>\n    <input type=\"text\" v-model=\"message\">\n    <button type=\"button\" @click=\"sendMsg()\">发送消息</button>\n    <br/><br/>\n    用户：<input type=\"text\" v-model=\"user\">\n    <button @click=\"joinRoom()\">加入群聊</button>\n    <button @click=\"exitRoom()\">退出群聊</button>\n</div>\n</template>\n<script>\nimport WebSocket from 'ws';\nexport default {\n  data() {\n    return {\n      url: 'ws://localhost:7078/Room/',\n      ws: null,\n      user: '',\n      message: '',\n      content: '',\n    }\n  },\n  created(){\n  },\n  methods: {\n    async joinRoom(){\n      if(this.ws) {\n        alert(\"你已经再聊天室\");\n        return;\n      }\n      let url = this.url;\n      let username = this.user;\n      this.ws = new WebSocket('wss://localhost:7078/Room/' + username);  // 后端的启动端口\n      this.ws.onopen = this.webscoketonopen;\n      this.ws.onmessage =  this.webscoketonmessage;\n      //发生错误触发\n      this.ws.onerror = function (event) {\n        console.log(\"连接错误\"+event)\n      };\n      //正常关闭触发\n      this.ws.onclose = function () {\n        console.log(\"连接关闭\");\n      };\n    }, \n    webscoketonopen(){\n      console.log(\"与服务器成功建立连接\");\n    },\n    webscoketonmessage(value){\n      console.log(value);\n      this.content += (value.data + '\\r\\n') ;\n    },\n    exitRoom(){\n      this.closeWebSocket();\n    },\n    sendMsg(){\n      if(!this.ws) {\n        alert('你已经掉线，请重新加入');\n        return;\n      }\n      if(this.ws.readyState === 1){\n        this.ws.send(this.message);\n        this.message = '';\n      } else {\n        alert('发送失败');\n      }\n    },\n    closeWebSocket(){\n      if(this.ws) {\n        this.ws.close();\n        this.ws = null;\n      }\n    },\n    talking(content) {\n      console.log(content);\n    }\n  }\n}\n</script>\n<style>\n.roomStyle{\n  text-align: center;\n  background-color: rgba(15, 161, 230, 0.35);\n  margin: 0 auto;\n  border: 1px solid #000;\n  width: 600px;\n  height: 650px\n}\n</style>"],"mappings":"AAaA,OAAOA,SAAQ,MAAO,IAAI;AAC1B,eAAe;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,GAAG,EAAE,2BAA2B;MAChCC,EAAE,EAAE,IAAI;MACRC,IAAI,EAAE,EAAE;MACRC,OAAO,EAAE,EAAE;MACXC,OAAO,EAAE;IACX;EACF,CAAC;EACDC,OAAOA,CAAA,EAAE,CACT,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,QAAQA,CAAA,EAAE;MACd,IAAG,IAAI,CAACN,EAAE,EAAE;QACVO,KAAK,CAAC,SAAS,CAAC;QAChB;MACF;MACA,IAAIR,GAAE,GAAI,IAAI,CAACA,GAAG;MAClB,IAAIS,QAAO,GAAI,IAAI,CAACP,IAAI;MACxB,IAAI,CAACD,EAAC,GAAI,IAAIH,SAAS,CAAC,4BAA2B,GAAIW,QAAQ,CAAC,EAAG;MACnE,IAAI,CAACR,EAAE,CAACS,MAAK,GAAI,IAAI,CAACC,eAAe;MACrC,IAAI,CAACV,EAAE,CAACW,SAAQ,GAAK,IAAI,CAACC,kBAAkB;MAC5C;MACA,IAAI,CAACZ,EAAE,CAACa,OAAM,GAAI,UAAUC,KAAK,EAAE;QACjCC,OAAO,CAACC,GAAG,CAAC,MAAM,GAACF,KAAK;MAC1B,CAAC;MACD;MACA,IAAI,CAACd,EAAE,CAACiB,OAAM,GAAI,YAAY;QAC5BF,OAAO,CAACC,GAAG,CAAC,MAAM,CAAC;MACrB,CAAC;IACH,CAAC;IACDN,eAAeA,CAAA,EAAE;MACfK,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC;IAC3B,CAAC;IACDJ,kBAAkBA,CAACM,KAAK,EAAC;MACvBH,OAAO,CAACC,GAAG,CAACE,KAAK,CAAC;MAClB,IAAI,CAACf,OAAM,IAAMe,KAAK,CAACpB,IAAG,GAAI,MAAM;IACtC,CAAC;IACDqB,QAAQA,CAAA,EAAE;MACR,IAAI,CAACC,cAAc,CAAC,CAAC;IACvB,CAAC;IACDC,OAAOA,CAAA,EAAE;MACP,IAAG,CAAC,IAAI,CAACrB,EAAE,EAAE;QACXO,KAAK,CAAC,aAAa,CAAC;QACpB;MACF;MACA,IAAG,IAAI,CAACP,EAAE,CAACsB,UAAS,KAAM,CAAC,EAAC;QAC1B,IAAI,CAACtB,EAAE,CAACuB,IAAI,CAAC,IAAI,CAACrB,OAAO,CAAC;QAC1B,IAAI,CAACA,OAAM,GAAI,EAAE;MACnB,OAAO;QACLK,KAAK,CAAC,MAAM,CAAC;MACf;IACF,CAAC;IACDa,cAAcA,CAAA,EAAE;MACd,IAAG,IAAI,CAACpB,EAAE,EAAE;QACV,IAAI,CAACA,EAAE,CAACwB,KAAK,CAAC,CAAC;QACf,IAAI,CAACxB,EAAC,GAAI,IAAI;MAChB;IACF,CAAC;IACDyB,OAAOA,CAACtB,OAAO,EAAE;MACfY,OAAO,CAACC,GAAG,CAACb,OAAO,CAAC;IACtB;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}